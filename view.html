<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>List Info</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

<div class="container-sm">
    <ul id="navDong" class="nav nav-pills">
      <li class="nav-item">
        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">동 </a>
      </li>
    </ul>

    <p class="h2" id="viewTitle">동 호 라인 (위에서 원하는 동을 선택)</p>

    <table id="viewList" class="table table-sm table-bordered">
    </table>

</div>

<script>
let viewList = document.querySelector('#viewList');
let navDong = document.querySelector('#navDong');

let thead = `
        <thead>
        <tr class="table-warning">
            <th style='width: 12.5%'>날짜 __NUM__w </th>
            __HEADER__
        </tr>
        </thead>`;

let tbody = `
    <tbody>
            <tr>
                <td style="width: 12.5%" class="table-active">
                    A: 10~13
                </td>
                __TR1__
            </tr>
            <tr>
                <td style="width: 12.5%" class="table-active">
                    B: 13~16
                </td>
                __TR2__
            </tr>
            <tr>
                <td style="width: 12.5%" class="table-active">
                    C: 16~19
                </td>
                __TR3__
            </tr>
    </tbody>`;

let yoils = ["<font color=red>일</font>", "월", "화", "수", "목", "금", "<font color=red>토</font>"];

/*numbers = [ [2,16],[2,17], [2,18], [2,19], [2,20], [2,21], [2,22] ]
printInnerHTML(numbers)
numbers = [ [2,23],[2,24], [2,25], [2,26], [2,27], [2,28], [2,29] ]
printInnerHTML(numbers)
numbers = [ [3,1],[3,2], [3,3], [3,4], [3,5], [3,6], [3,7] ]
printInnerHTML(numbers)
*/
printNabDong();
loopWeek();

function printNabDong() {
    nav1 = `
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">__DONG__</a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="?dong=__DONG__&line=L12">12라인</a>
          <a class="dropdown-item" href="?dong=__DONG__&line=L34">34라인</a>
          <a class="dropdown-item" href="?dong=__DONG__&line=L56">56라인</a>
        </div>
      </li>`;
    nav2 = `
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">__DONG__</a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="?dong=__DONG__&line=L123">123라인</a>
          <a class="dropdown-item" href="?dong=__DONG__&line=L45">45라인</a>
        </div>
      </li>`;

    nav = "";
    for (var i = 101; i < 112; i++) {
        nav += replaceAll(nav1, "__DONG__", i);
    }
    for (var i = 112; i < 115; i++) {
        nav += replaceAll(nav2, "__DONG__", i);
    }
    nav += `<li class="nav-item">
            <a class="nav-link" href="register.html">[이사일등록]</a>
          </li>`;
    navDong.innerHTML = nav;
}
function loopWeek() {
    sdate = new Date("02/16/2020");   // 2020-02-16    
    for (var j = 0; j < 13; j++) {
        numbers = [ ];
        for (var i = j*7; i < j*7+7; i++) {
            var newdate = new Date(sdate);
            newdate.setDate(newdate.getDate() + i);
            mm = newdate.getMonth() + 1;
            dd = newdate.getDate();
            numbers.push([mm,dd]);
        }
        printInnerHTML(numbers, j+1)
    }
}

function replaceAll(str, searchStr, replaceStr) {
  return str.split(searchStr).join(replaceStr);
}

function printInnerHTML(numbers, num) {
    soTh = ""
    soTr1 = ""
    viewRaw = ""
    numbers.forEach(myFunction);
    viewRaw += thead.replace("__HEADER__", soTh).replace("__NUM__", num);
    viewRaw += tbody.replace("__TR1__", soTr1).replace("__TR2__", replaceAll(soTr1, "-A", "-B")).replace("__TR3__", replaceAll(soTr1, "-A", "-C"));
    viewList.innerHTML += viewRaw
}

function myFunction(value, index, array) {
  //console.log(value[0] +"/"+ value[1]);
  soTh += "<th style='width: 12.5%'>"+ value[0] + "/" + value[1] + " ("+ yoils[index] +")</th>";
  soTr1 += `<td style='width: 12.5%'>
               <div id='m`+ value[0] +`-`+ value[1] + `-A'><span class='badge badge-light'>-</span></div>
            </td>`;
}
</script>


<script src="https://www.gstatic.com/firebasejs/5.10.0/firebase.js"></script>
<script src="app.js"></script>
<script src="view.js"></script>

</body>
</html>